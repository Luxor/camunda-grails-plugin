<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>camunda Grails plugin 0.3.0</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
    </head>

    <body class="body" onload="addJsClass();">
        <div id="navigation">
            <ul>
                <li>
                    <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                        <a href="../guide/index.html" class="button">Table of contents</a>
                        <div id="nav-summary-childs" style="display:none;">
                            
                            <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#get-started"><strong>2</strong><span>Get Started</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#conventions"><strong>3</strong><span>A Word about Conventions</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#usage"><strong>4</strong><span>User Guide</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#testing"><strong>5</strong><span>Testing Guide</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#resources"><strong>6</strong><span>Further Resources</span></a></div>
                            
                        </div>
                    </div>
                </li>
                <li class="separator selected">
                    <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
                </li>
            </ul>
        </div>
        <div id="header">
            <div class="images clearfix">
                
                <span id="logo"><span style="white-space: nowrap"><img alt="camunda Logo" title="camunda Grails plugin" src="http://plexiti.github.io/camunda-grails-plugin/img/camunda.png" style="margin-right: 10px"/><span style="vertical-align: middle; font-size: 2.5em">camunda Grails plugin</span><br/><br/></span></span>
                
                
                <span id="sponsor"><span style="vertical-align: middle"><a href="http://plexiti.com" target="_blank"><img alt="plexiti Logo" title="plexiti GmbH" src="http://plexiti.github.io/camunda-grails-plugin/img/plexiti.png"/></a></span></span>
                
            </div>
            <p>The camunda Grails plugin integrates the camunda BPM platform with the Grails web application framework.</p>
        </div>


        <table id="colset" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td id="col1">
                    <div id="main" class="corner-all">

                        <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                        <div class="project">
                            <h1>camunda Grails plugin - Reference Documentation</h1>
                            <p><strong>Authors:</strong> Martin Schimak</p>
                            <p><strong>Version:</strong> 0.3.0</p>
                            
                        </div>

                        
                        <div id="table-of-content">
                            <h2>Table of Contents</h2>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#get-started"><strong>2</strong><span>Get Started</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#install"><strong>2.1</strong><span>Install the plugin</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#create-process"><strong>2.2</strong><span>Create a process definition</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#execute-test"><strong>2.3</strong><span>Execute the integration test</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#conventions"><strong>3</strong><span>A Word about Conventions</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#usage"><strong>4</strong><span>User Guide</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#script-create-process"><strong>4.1</strong><span>Create a process definition</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#services"><strong>4.2</strong><span>Inject camunda API Services</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#configuration"><strong>4.3</strong><span>Configure the camunda plugin</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#deployment-scenario"><strong>4.3.1</strong><span>Set the deployment scenario</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#process-engine-configuration"><strong>4.3.2</strong><span>Configure your process engine</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#configuration-possibilities"><strong>4.3.3</strong><span>Use primitive types, any object or even spring beans</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#jul-logging"><strong>4.3.4</strong><span>Consider 'java.util.logging' settings</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#alternative-database"><strong>4.3.5</strong><span>Use a different database</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#alternative-engine-version"><strong>4.3.6</strong><span>Use an alternative version of camunda</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#bean-names"><strong>4.3.7</strong><span>Provide alternative bean names</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#override-configuration"><strong>4.3.8</strong><span>Override plugin configuration with custom beans</span></a></div>
                            
                            <div class="toc-item" style="margin-left:20px"><a href="#auto-reload-configuration"><strong>4.3.9</strong><span>Configure auto reloading of bpmn process definitions</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#testing"><strong>5</strong><span>Testing Guide</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#drive-process"><strong>5.1</strong><span>Drive the process instances</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#mock-services"><strong>5.2</strong><span>Mock the service calls</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#auto-reload"><strong>5.3</strong><span>Auto reload and redeploy your bpmn process definitions</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#resources"><strong>6</strong><span>Further Resources</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#plugin-resources"><strong>6.1</strong><span>camunda Grails plugin</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#camunda-resources"><strong>6.2</strong><span>camunda BPM</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#modeler-resources"><strong>6.3</strong><span>camunda Modeler</span></a></div>
                            
                            <div style="clear:both" ></div>
                        </div>
                        
                        

<h1 id="introduction">1 Introduction</h1>
This plugin integrates the camunda BPM platform with the Grails web application framework.
<strong class="bold"><a href="http://camunda.org" target="blank">camunda BPM</a></strong> is a flexible framework for workflow and process automation.
It's core is a native <strong class="bold"><a href="http://www.omg.org/spec/BPMN/2.0/" target="blank">BPMN 2.0</a></strong> process engine that runs
inside the Java Virtual Machine. It is a perfect match for the Spring Framework - and therefore for
<strong class="bold"><a href="http://grails.org" target="blank">Grails</a></strong>, too.<p class="paragraph"/>Please check out <strong class="bold"><a href="http://camunda.org/" target="blank">camunda.org</a></strong> to get started with camunda BPM. Read on here
to get started with the camunda Grails plugin!<p class="paragraph"/><img border="0" class="center" src="../img/modeler.png"></img>


<h1 id="get-started">2 Get Started</h1>



<h2 id="install">2.1 Install the plugin</h2>
In your BuildConfig.groovy configure the following plugin dependency:<p class="paragraph"/><div class="code"><pre>plugins &#123;
    compile &#34;:camunda:0.2.0"
&#125;</pre></div><p class="paragraph"/>You may want to refresh your dependencies now in order to make sure that Grails properly
installs the plugin. Type on your command line<p class="paragraph"/><div class="code"><pre>grails refresh&#45;dependencies</pre></div>



<h2 id="create-process">2.2 Create a process definition</h2>
You can now create a <strong class="bold">BPMN 2.0</strong> process definition by issueing the following command:<p class="paragraph"/><div class="code"><pre>grails create&#45;process &#91;name&#93;</pre></div><p class="paragraph"/>As name choose a 'package and class' like name of your choice, e.g. "<strong class="bold">org.camunda.my.TestProcess</strong>".
You should see the following two files generated by Grails:<p class="paragraph"/><div class="code"><pre>| Created file grails&#45;app/processes/org/camunda/my/TestProcess.bpmn
| Created file test/integration/org/camunda/my/TestProcessSpec.groovy</pre></div><p class="paragraph"/>You may now want to look at the generated BPMN process definition by making use of <a href="http://camunda.org/bpmn/tool/" target="blank">camunda
modeler</a>. It's a minimal process, to get you started and build upon:<p class="paragraph"/><img border="0" class="center" src="../img/TestProcess.png"></img><p class="paragraph"/>Furthermore you will find a 'spock' based integration spec executing and checking that process. It
does have a bit more content than your typical almost empty Grails spec template...<p class="paragraph"/><div class="code"><pre>&#91;...&#93;
given: <span class="java&#45;quote">"a <span class="java&#45;keyword">new</span> instance of TestProcess"</span>
runtimeService.startProcessInstanceByKey(<span class="java&#45;quote">"TestProcess"</span>)<p class="paragraph"/>when: <span class="java&#45;quote">"completing the user task"</span>
def task = taskService.createTaskQuery().singleResult()
taskService.complete(task.id)<p class="paragraph"/>then: <span class="java&#45;quote">"the service method defined <span class="java&#45;keyword">for</span> the subsequent service task was called exactly once"</span>
1 &#42; sampleTestProcessService.serviceMethod()
&#91;...&#93;</pre></div><p class="paragraph"/>&#8230; again to get you started with typical process testing boilerplate readily adapted to your
freshly created process definition and to build upon. You can directly execute that test:



<h2 id="execute-test">2.3 Execute the integration test</h2>
<blockquote class="note">Beware that this test will populate your test environment database with camunda related
tables. By default, this will be a H2 in memory database preconfigured by Grails - so everything
fine with that. For other databases, you will need to adapt the <a href="../guide/single.html#alternative-database" class="guide">plugin
configuration</a>, too.</blockquote><p class="paragraph"/><div class="code"><pre>grails test&#45;app integration: org.camunda.my.TestProcess</pre></div><p class="paragraph"/>When executing the test you should see the following familiar output :-)<p class="paragraph"/><div class="code"><pre>| Running 1 integration test&#8230; 1 of 1
| Completed 1 integration test, 0 failed in 0m 0s
| Tests PASSED &#45; view reports in ./target/test&#45;reports</pre></div><p class="paragraph"/><strong class="bold">Congrats!</strong> You are successfully using camunda BPM with the Grails framework!


<h1 id="conventions">3 A Word about Conventions</h1>
Grails uses <a href="http://grails.org/doc/latest/guide/gettingStarted.html#conventionOverConfiguration" target="blank">convention over
configuration</a> to configure
itself. This typically means that the names and locations of files are used instead of explicit configuration.
Following this paradigm and the approach of other plugins like e.g. <a href="http://grails.org/plugin/quartz" target="blank">quartz</a> or
<a href="http://grails.org/plugin/routing" target="blank">routing</a>, the <strong class="bold">camunda</strong> plugin adds the "grails-app/processes" folder as soon as
you create your first process via the <a href="../ref/Command Line/create-process.html" class="Command Line">create-process</a> command:
<ul class="star">
<li><strong class="bold">your-project</strong> = top level project directory</li>
<ul class="star">
<li><strong class="bold">grails-app</strong> = standard grails layout directory</li>
<ul class="star">
<li><strong class="bold">processes</strong> = process definitions directory for *.bpmn resources</li>
</ul></ul></ul><p class="paragraph"/>Within that folder you may choose to group your <strong class="bold">&#42;.bpmn</strong> process definitions into packages. Every <strong class="bold">&#42;.bpmn</strong> file
inside that directory will go into your <strong class="bold">&#42;.war</strong> when packaging it via Grails. (You may then choose to
automatically redeploy those process definitions - or not - by explicitely configuring the 'deploymentResources'
setting of your <a href="../guide/single.html#process-engine-configuration" class="guide">configuration</a>.)<p class="paragraph"/>The <a href="../ref/Command Line/create-process.html" class="Command Line">create-process</a> command uses another two naming conventions. The name you choose for your process
will be suffixed with <strong class="bold">&#42;Process.bpmn</strong> - in case you haven't provided that yourself as a part of the name.
Therefore issueing e.g.<p class="paragraph"/><div class="code"><pre>grails create&#45;process org.camunda.my.Test</pre></div><p class="paragraph"/>will result in the following two files being generated for you:<p class="paragraph"/><div class="code"><pre>| Created file grails&#45;app/processes/org/camunda/my/TestProcess.bpmn
| Created file test/integration/org/camunda/my/TestProcessSpec.groovy</pre></div><p class="paragraph"/>Furthermore, every executable BPMN process must have an id defined inside its xml structure. The plugin takes care
of generating this id for you - in the given example as "TestProcess", hence the name of the generated bpmn
resource - but without package name and file extension:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;process id=<span class="xml&#45;quote">"TestProcess"</span> name=<span class="xml&#45;quote">"TestProcess"</span> isExecutable=<span class="xml&#45;quote">"true"</span>&#62;</span>
  &#8230;
<span class="xml&#45;tag">&#60;/process&#62;</span></pre></div><p class="paragraph"/>When editing this freshly generated process definition with <a href="http://camunda.org/bpmn/tool/" target="blank">camunda modeler</a>, you
will see this id when opening the "properties" pane and clicking into the free area of the diagram:<p class="paragraph"/><img border="0" class="center" src="../img/TestProcessModeler.png"></img><p class="paragraph"/><blockquote class="note">Feel free to change the generated 'name' attribute to a better human readable version of the name!</blockquote><p class="paragraph"/>This 'id' attribute is needed when using the <a href="../guide/single.html#services" class="guide">camunda API services</a>, like e.g. starting a process
instance by 'key' (which is referring to this id attribute):<p class="paragraph"/><div class="code"><pre>runtimeService.startProcessInstanceByKey(<span class="java&#45;quote">"TestProcess"</span>)</pre></div><p class="paragraph"/>Both conventions - the <strong class="bold">&#42;Process</strong> suffix as well as the artifact 'id' being unique across packages follow typical
Grails conventions and therefore make sense for greenfield projects. However, the plugin will not strictly enforce
these conventions. You may choose to place other <strong class="bold">&#42;.bpmn</strong> files into your grails-app/processes folder and they
will be accessible by integration tests, bundled into the war and deployed to the engine, too.<p class="paragraph"/>


<h1 id="usage">4 User Guide</h1>
After having <a href="../guide/single.html#install" class="guide">installed</a> the plugin you can immediately start to use the camunda
process engine.


<h2 id="script-create-process">4.1 Create a process definition</h2>
You can create a <strong class="bold">BPMN 2.0</strong> process definition by issueing the following command:<p class="paragraph"/><div class="code"><pre>grails create&#45;process &#91;name&#93;</pre></div><p class="paragraph"/>As name choose a 'package and class' like name of your choice, e.g. "<strong class="bold">org.camunda.my.TestProcess</strong>".
You should see the following two files generated by Grails:<p class="paragraph"/><div class="code"><pre>| Created file grails&#45;app/processes/org/camunda/my/TestProcess.bpmn
| Created file test/integration/org/camunda/my/TestProcessSpec.groovy</pre></div><p class="paragraph"/>You may now want to look at the generated BPMN process definition by making use of <a href="http://camunda.org/bpmn/tool/" target="blank">camunda
modeler</a>. It's a minimal process, but enough to get you started with user tasks and
services and to build upon:<p class="paragraph"/><img border="0" class="center" src="../img/TestProcessModeler.png"></img><p class="paragraph"/>Furthermore you will find a 'spock' based integration spec executing and checking that process. It
does have a bit more content than your typical almost empty Grails spec template...<p class="paragraph"/><div class="code"><pre>&#91;...&#93;
given: <span class="java&#45;quote">"a <span class="java&#45;keyword">new</span> instance of TestProcess"</span>
runtimeService.startProcessInstanceByKey(<span class="java&#45;quote">"TestProcess"</span>)<p class="paragraph"/>when: <span class="java&#45;quote">"completing the user task"</span>
def task = taskService.createTaskQuery().singleResult()
taskService.complete(task.id)<p class="paragraph"/>then: <span class="java&#45;quote">"the service method defined <span class="java&#45;keyword">for</span> the subsequent service task was called exactly once"</span>
1 &#42; sampleTestProcessService.serviceMethod()
&#91;...&#93;</pre></div><p class="paragraph"/>&#8230; again to get you started with typical process testing boilerplate readily adapted to your freshly created
process definition and to build upon. Please check out the chapter about <a href="../guide/single.html#conventions" class="guide">conventions</a> in order
to fully appreciate the consequences of the process template being generated for you.



<h2 id="services">4.2 Inject camunda API Services</h2>
You can inject the camunda process engine API services into your grails artifacts (like
controllers, services, etc). The following services can be found in the package
<a href="http://docs.camunda.org/latest/api-references/javadoc/org/camunda/bpm/engine/package-summary.html" target="blank">org.camunda.bpm.engine</a>
and are made available under their 'bean style' class names, as shown here in alphabetical order:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> org.camunda.bpm.engine.&#42;
&#8230; 
AuthorizationService authorizationService
FormService formService
HistoryService historyService
IdentityService identityService
ManagementService managementService
RepositoryService repositoryService
RuntimeService runtimeService
TaskService taskService</pre></div><p class="paragraph"/><blockquote class="note"> Note that many of these bean names are quite generic (like 'taskService', 'managementService' etc) and
could easily clash with names you want to use in your application for other purposes - even more so when having in
mind the Grails naming convention to use <strong class="bold">&#42;Service</strong> as a name pattern for Grails services. On the other hand
typical camunda users are used to the service names shown above and will expect to use these services via their
established names. Therefore the plugin provides these services via those names shown above. However, in order to
avoid potential name conflicts with grails services pre-existing in your project, the plugin also allows to
<strong class="bold">change these default bean names</strong> via <a href="../guide/single.html#bean-names" class="guide">configuration</a>. </blockquote><p class="paragraph"/>In addition to the camunda API services, the ProcessEngine itself can be used as an injectable
dependency, too:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> org.camunda.bpm.engine.&#42;
&#8230; 
ProcessEngine processEngine</pre></div><p class="paragraph"/>


<h2 id="configuration">4.3 Configure the camunda plugin</h2>
It is not necessary to add configuration in order to <a href="../guide/single.html#get-started" class="guide">get started</a>. However,
you will need some configuration to deploy to other environments than <strong class="bold">dev</strong>elopment and <strong class="bold">test</strong>.
The plugin provides the possibility to adapt to your specific requirements by adding a new
section '<strong class="bold">camunda</strong>' to your <strong class="bold">Config.groovy</strong> (either top-level or beneath a specific environment):<p class="paragraph"/><div class="code"><pre>camunda &#123;
  &#8230;
&#125;</pre></div><p class="paragraph"/><blockquote class="note"> You will need such a configuration section to deploy to other environments than
<strong class="bold">dev</strong>elopment and <strong class="bold">test</strong>. Find out more in the following two chapters. </blockquote>


<h2 id="deployment-scenario">4.3.1 Set the deployment scenario</h2>
You can set the <a href="http://docs.camunda.org/latest/guides/user-guide/#introduction-architecture-overview-camunda-bpm-platform-architecture" target="blank">deployment
scenario</a>
for your process engine. The plugin currently supports the deployment scenarios 
<ul class="minus">
<li>'<strong class="bold">embedded</strong>' (default): the process engine is embedded into your grails application and started and stopped with your grails application lifecycle</li>
<li>'<strong class="bold">none</strong>': the process engine configuration and startup is turned off</li>
</ul><p class="paragraph"/><div class="code"><pre>camunda &#123;
  deployment.scenario = <span class="java&#45;quote">"embedded"</span> // (or <span class="java&#45;quote">"none"</span>)
&#125;</pre></div><p class="paragraph"/><blockquote class="note">
The value 'embedded' is the <strong class="bold">default</strong> in case you do not set and change it explicitely.
</blockquote>



<h2 id="process-engine-configuration">4.3.2 Configure your process engine</h2>
You can fully control your embedded camunda process engine configuration via Config.groovy:<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      &#8230;
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/>Find a full specification of the values possible in the camunda docs for the spring <a href="http://docs.camunda.org/latest/api-references/javadoc/org/camunda/bpm/engine/spring/SpringProcessEngineConfiguration.html" target="blank">process
engine configuration</a>.<p class="paragraph"/>Note that in case you do not configure a value the plugin relies on the default values coming
with the camunda engine in use - with the following three exceptions for the default grails
environments <strong class="bold">dev</strong>elopment and <strong class="bold">test</strong>:
<ul class="minus">
<li>your database is populated with camunda tables the first time the database is accessed</li>
<li>any *.bpmn process definitions found in the classpath will be deployed to the database</li>
<li>the job executor is turned on</li>
</ul><p class="paragraph"/><blockquote class="note">This choice was made in order to make it as easy as possible to <a href="../guide/single.html#get-started" class="guide">get
started</a> while relying on explicit configuration choices when deploying to
other (and potentially production) databases.</blockquote><p class="paragraph"/>That means if you want to have that same behaviour for any other environment, you need to
explicitely configure that in Config.groovy:<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      databaseSchemaUpdate = <span class="java&#45;keyword">true</span>
      deploymentResources = &#91;'classpath:/&#42;&#42;/&#42;.bpmn'&#93;
      jobExecutorActivate = <span class="java&#45;keyword">true</span>
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/>Obviously you can also change the configuration for the environments development and test, for
the sake of the example e.g. to the current camunda defaults used for the grails environment
<strong class="bold">prod</strong>uction:<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      databaseSchemaUpdate = <span class="java&#45;keyword">false</span>
      deploymentResources = &#91;&#93;
      jobExecutorActivate = <span class="java&#45;keyword">false</span>
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/><blockquote class="note"> Please be aware that during integration test phase of any environment, two more camunda
configuration values are set by the plugin: the camunda job executor is turned off and service
mocking is made available. Find more information about that in section
<a href="../guide/single.html#testing" class="guide">testing</a>.</blockquote>


<h2 id="configuration-possibilities">4.3.3 Use primitive types, any object or even spring beans</h2>
For configuration, you can of course use primitive typed configuration values such as Strings and booleans, like e.g.<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      processEngineName = <span class="java&#45;quote">"myCustomName"</span>
      databaseSchemaUpdate = <span class="java&#45;keyword">false</span>
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/>but also any object available in Config.groovy or directly constructed within it, like e.g.<p class="paragraph"/><div class="code"><pre>List&#60;BpmnParseListener&#62; parseHandlers = <span class="java&#45;keyword">new</span> ArrayList&#60;BpmnParseListener&#62;();
parseHandlers.add(<span class="java&#45;keyword">new</span> CustomParseHandler());<p class="paragraph"/>camunda &#123;
    engine &#123;
        configuration &#123;
            preParseListeners = parseHandlers
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/>or even spring beans configured e.g. via '<strong class="bold">grails-app/conf/spring/resources.groovy</strong>' or e.g. via '<strong class="bold">grails-app/conf/DataSource.groovy</strong>',
simply referencing them via their <strong class="bold">bean name</strong>:<p class="paragraph"/><div class="code"><pre>camunda &#123;
    engine &#123;
        configuration &#123;
            dataSource = <span class="java&#45;quote">"dataSource_camunda"</span>
        &#125;
    &#125;
&#125;</pre></div>



<h2 id="jul-logging">4.3.4 Consider 'java.util.logging' settings</h2>
camunda uses <a href="http://docs.camunda.org/latest/guides/user-guide/#process-engine-logging" target="blank">java.util.logging</a>.
Therefore you need to make a conscious choice about whether to turn on/off the 'grails.logging.jul.usebridge'
setting in your Config.groovy. See the information about the performance impact on
<a href="http://www.slf4j.org/legacy.html#jul-to-slf4j" target="blank">http://www.slf4j.org</a>.<p class="paragraph"/><strong class="bold">In case the bridge is not turned off explicitely by you, the plugin will turn it on for all Grails test phases.</strong>
However, your explicit choice won't be overridden.<p class="paragraph"/><blockquote class="note">This decision in particular makes sure that the bridge is turned on for tests executed in the default Grails
environment '<strong class="bold">test</strong>', for which no explicit setting is made in the default grails application. As soon as you make
an explicit decision for any of your default or custom environments, the plugin won't interfere anymore.</blockquote>


<h2 id="alternative-database">4.3.5 Use a different database</h2>
camunda's ORM mapping is provided by the mybatis mapping framework. Therefore the plugin can -
and does by default - reuse your Grails 'dataSource' and 'transactionManager' beans, however it
needs to be informed about a databaseType different from Grails default 'h2':<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      databaseType = <span class="java&#45;quote">"postgres"</span> // one of (as of writing): &#91;h2, mysql, oracle, postgres, mssql, db2&#93;
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/>Find here a list of camunda's <a href="http://docs.camunda.org/7.0/guides/user-guide/#introduction-supported-environments" target="blank">enviroments supported</a> 
by the version bundled with the plugin and the corresponding 
<a href="http://docs.camunda.org/latest/guides/user-guide/#process-engine-database-configuration" target="blank">configuration values</a> 
for different database types.<p class="paragraph"/>You can also point the process engine to a different database than the one you use for your grails 
domain objects. First configure it in your '<strong class="bold">grails-app/conf/DataSource.groovy</strong>'...<p class="paragraph"/><div class="code"><pre>dataSource &#123;
  dbCreate = <span class="java&#45;quote">"create&#45;drop"</span> // one of 'create', 'create&#45;drop', 'update', 'validate', ''
  url = <span class="java&#45;quote">"jdbc:h2:mem:devDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE"</span>
&#125;
&#8230;
dataSource_camunda &#123;
  dbCreate = <span class="java&#45;quote">"create&#45;drop"</span> // one of 'create', 'create&#45;drop', 'update', 'validate', ''
  url = <span class="java&#45;quote">"jdbc:h2:mem:devDbCamunda;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE"</span>
&#125;</pre></div><p class="paragraph"/>&#8230; then reference this alternative dataSource bean in '<strong class="bold">grails-app/conf/Config.groovy</strong>':<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      dataSource = <span class="java&#45;quote">"dataSource_camunda"</span>
    &#125;
  &#125;
&#125;</pre></div>



<h2 id="alternative-engine-version">4.3.6 Use an alternative version of camunda</h2>
Currently the plugin comes bundled with a dependency to the release <strong class="bold">7.1.0-Final</strong> of camunda BPM.
However you may want to choose another version. You then have to explicitely override the needed 
dependencies in your BuildConfig.groovy:<p class="paragraph"/><div class="code"><pre>dependencies &#123;
  compile (<span class="xml&#45;quote">"org.camunda.bpm:camunda&#45;engine:$camundaVersion"</span>) &#123;
    excludes 'spring&#45;beans'
  &#125;
  runtime (<span class="xml&#45;quote">"org.camunda.bpm:camunda&#45;engine&#45;spring:$camundaVersion"</span>) &#123;
    excludes 'spring&#45;context', 'spring&#45;jdbc', 'spring&#45;orm'
  &#125;
&#125;</pre></div><p class="paragraph"/>Replace '$camundaVersion' with the version of camunda of your choice. It is recommended to
explicitely exclude any spring dependencies coming with camunda and make sure to properly test
your application with the spring framework version provided by the Grails version you use.<p class="paragraph"/>Note that for camunda versions prior to 7.1.0-Final, you must also configure camunda's custom 
maven repository:<p class="paragraph"/><div class="code"><pre>repositories &#123;
    mavenRepo <span class="java&#45;quote">"https://app.camunda.com/nexus/content/groups/<span class="java&#45;keyword">public</span>"</span>
  &#125;</pre></div>



<h2 id="bean-names">4.3.7 Provide alternative bean names</h2>
Many of camunda's API service names are quite generic (like 'taskService', 'managementService' etc) and could
easily clash with names you want to use in your application for other purposes - even more so when having in mind
the Grails naming convention to use <strong class="bold">&#42;Service</strong> as a name pattern for Grails services. On the other hand typical
camunda users are used to the established service names and will expect to use these services via their
established names. Therefore the plugin provides these services via the <a href="../guide/single.html#services" class="guide">established names</a>.
However, in order to avoid potential name conflicts with grails services pre-existing in your project, the plugin
also allows to change these default bean names via configuration:<p class="paragraph"/><div class="code"><pre>camunda &#123;
  beans.runtimeService = 'myCamundaRuntimeService'
&#125;</pre></div><p class="paragraph"/>Internally the plugin realises this with Spring's bean aliasing mechanism. Instead of the default 
alias 'runtimeService' the custom alias 'myCamundaRuntimeService' is used. You can then inject
your 'org.camunda.bpm.engine.RuntimeService'-typed bean as<p class="paragraph"/><div class="code"><pre>def myCamundaRuntimeService</pre></div>


<h2 id="override-configuration">4.3.8 Override plugin configuration with custom beans</h2>
Of course, it is also possible to override some or all of the camunda spring beans defined by the
plugin via the standard Grails way: by editing '<strong class="bold">grails-app/conf/spring/resources.groovy</strong>'. In
order to do that properly it is useful to know that the plugin registers all beans following the
name convention <strong class="bold">camunda&#91;DefaultAlias&#93;Bean</strong>, e.g. the 'processEngine' is registered as bean
'camundaProcessEngineBean', then given either its default alias 'processEngine' (or its <a href="../guide/single.html#bean-names" class="guide">custom
alias</a> defined by the user).<p class="paragraph"/><blockquote class="note"> This decision was made partly in order to allow the configuration of <a href="../guide/single.html#bean-names" class="guide">alternative bean
names</a>, partly because some historic 2.3 versions of Grails display issues with
custom spring beans named in potential "conflict" with the *Service name convention for Grails
services. </blockquote>



<h2 id="auto-reload-configuration">4.3.9 Configure auto reloading of bpmn process definitions</h2>
You can automatically reload and redeploy '<strong class="bold">.bpmn</strong>' process definitions placed beneath 
'<strong class="bold">grails-app/processes</strong>'. When changing the process definition while you are running 
your application with '<strong class="bold">run-app</strong>', it will be redeployed to the process engine.<p class="paragraph"/>You can turn this feature on/off explicitely:<p class="paragraph"/><div class="code"><pre>camunda &#123;
  deployment.autoreload = <span class="java&#45;keyword">true</span> // (or <span class="java&#45;keyword">false</span>)
&#125;</pre></div><p class="paragraph"/><blockquote class="note">
The autoreload feature is <strong class="bold">by default enabled</strong> for grails 'dev' and 'test' environments. 
For all other environments it is by default disabled.
</blockquote>



<h1 id="testing">5 Testing Guide</h1>
During the integration test phase of Grails (any environment), two configuration values are set by the plugin: the
camunda <a href="http://docs.camunda.org/latest/guides/user-guide/#process-engine-the-job-executor" target="blank">job executor</a> is *by
default<strong class="bold"> turned </strong>off* and service <a href="http://docs.camunda.org/latest/guides/user-guide/#testing-using-mocks-to-test-your-process-application" target="blank">mocking</a>
is made available.<p class="paragraph"/><blockquote class="note">Beware: you can explicitely turn on/off the job executor in your environment by
<a href="../guide/single.html#configuration" class="guide">configuration</a>. In this case the plugin will not interfere with your explicit choice!</blockquote><p class="paragraph"/>In essence this behaviour makes sure that you can perform your tests
<ul class="star">
<li>in a single-threaded manner, fully controlled by your test code, and without having the job executor interfering from background threads.</li>
<li>with the possibility to mock your service calls from within the process</li>
</ul><p class="paragraph"/>


<h2 id="drive-process">5.1 Drive the process instances</h2>
For testing purposes, you can (and must!) explicitely "drive" your process whenever it arrives at a "wait state".
Please review the discussion about <a href="http://docs.camunda.org/latest/guides/user-guide/#process-engine-transactions-in-processes" target="blank">transactions in
processes</a> to learn
more about that. Such a wait state is always reached for e.g. user tasks, but with the job executor turned off in
particular also for service tasks marked to be <a href="http://docs.camunda.org/latest/guides/user-guide/#process-engine-transactions-in-processes-asynchronous-continuations" target="blank">continued
asynchronously</a>:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;serviceTask id=<span class="xml&#45;quote">"myServiceTask"</span> &#8230; camunda:async=<span class="xml&#45;quote">"true"</span>&#62;</span>
&#8230;
<span class="xml&#45;tag">&#60;/serviceTask&#62;</span></pre></div><p class="paragraph"/>In such a case you must now mimic the work of the background job executor and explicitely tell the process to
"move on" with execution, e.g. by writing:<p class="paragraph"/><div class="code"><pre>def job = managementService.createJobQuery().processInstanceId(pid).singleResult()
managementService.executeJob(job.id)</pre></div>



<h2 id="mock-services">5.2 Mock the service calls</h2>
You can call services from within your process via <a href="http://juel.sourceforge.net" target="blank">JUEL</a> expressions, like e.g.<p class="paragraph"/><div class="code"><pre>&#60;serviceTask id=<span class="java&#45;quote">"myServiceTask"</span> camunda:expression=<span class="java&#45;quote">"&#35;&#123;sampleTestProcessService.serviceMethod()&#125;"</span> &#8230; &#62;
&#8230;
&#60;/serviceTask&#62;</pre></div><p class="paragraph"/>For your tests, instead of calling your actual service 'sampleTestProcessService' you can call a mock, like e.g.<p class="paragraph"/><div class="code"><pre>def sampleTestProcessService = Mock(SampleTestProcessService)
org.camunda.bpm.engine.test.mock.Mocks.register(<span class="java&#45;quote">"sampleTestProcessService"</span>, sampleTestProcessService)</pre></div><p class="paragraph"/>This will make sure that the juel identifier 'sampleTestProcessService' will be resolved to the mock instance,
provided you use the
<a href="http://docs.camunda.org/latest/api-references/javadoc/org/camunda/bpm/engine/test/mock/MockExpressionManager.html" target="blank">MockExpressionManager</a>
for resolving your JUEL expression identifiers - which is what the plugin will make sure for Grails' integration test
phase.


<h2 id="auto-reload">5.3 Auto reload and redeploy your bpmn process definitions</h2>
You can automatically reload and redeploy '<strong class="bold">.bpmn</strong>' process definitions placed beneath 
'<strong class="bold">grails-app/processes</strong>'. When changing the process definition while you are running 
your application with '<strong class="bold">run-app</strong>', it will be redeployed to the process engine.<p class="paragraph"/>Also check the possibility to turn this feature on/off explicitely <a href="../guide/single.html#auto-reload-configuration" class="guide">by configuration</a>.



<h1 id="resources">6 Further Resources</h1>



<h2 id="plugin-resources">6.1 camunda Grails plugin</h2>
<ul class="star">
<li><a href="http://plexiti.github.io/camunda-grails-plugin" target="blank">Documentation</a></li>
<li><a href="https://github.com/plexiti/camunda-grails-plugin" target="blank">GitHub Repository</a></li>
<li><a href="https://github.com/plexiti/camunda-grails-plugin/issues" target="blank">Issue Tracking</a></li>
<li><a href="https://github.com/martinschimak/camunda-grails-plugin/issues/milestones" target="blank">Roadmap</a></li>
<li><a href="https://github.com/martinschimak/camunda-grails-plugin/issues/milestones?state=closed" target="blank">Changelog</a></li>
</ul><p class="paragraph"/>


<h2 id="camunda-resources">6.2 camunda BPM</h2>
<ul class="star">
<li><a href="http://docs.camunda.org/latest/guides/user-guide/" target="blank">User Guide</a></li>
<li><a href="http://docs.camunda.org/latest/guides/installation-guide/" target="blank">Installation Guide</a></li>
<li><a href="http://docs.camunda.org/latest/api-references/bpmn20/" target="blank">BPMN 2.0 Implementation Reference</a></li>
<li><a href="http://docs.camunda.org/latest/api-references/javadoc/" target="blank">Java API</a></li>
<li><a href="https://github.com/orgs/camunda" target="blank">GitHub Repositories</a></li>
<li><a href="https://app.camunda.com/jira/browse/CAM" target="blank">Issue Tracking</a></li>
</ul><p class="paragraph"/>


<h2 id="modeler-resources">6.3 camunda Modeler</h2>
<ul class="star">
<li><a href="http://camunda.org/bpmn/tool/download/" target="blank">BPMN 2.0 Modeler</a></li>
<li><a href="http://camunda.org/bpmn/reference.html" target="blank">BPMN 2.0 Modeling Reference</a></li>
</ul><p class="paragraph"/>

                    </div>
                </td>
                <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Beans</h1><div class="menu-sub">
                        
                        
                        <div class="menu-item"><a href="../ref/Beans/authorizationService.html">authorizationService</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Beans/formService.html">formService</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Beans/historyService.html">historyService</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Beans/identityService.html">identityService</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Beans/managementService.html">managementService</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Beans/processEngine.html">processEngine</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Beans/repositoryService.html">repositoryService</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Beans/runtimeService.html">runtimeService</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Beans/taskService.html">taskService</a>
                        </div>
                        
                        </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Command Line</h1><div class="menu-sub">
                        
                        
                        <div class="menu-item"><a href="../ref/Command%20Line/create-process.html">create-process</a>
                        </div>
                        
                        </div>
                    </div>
                    
                </div>
            </div>
        </td>
            </tr>
        </table>

        <div id="footer">
            <div>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons 4.0" style="border-width:0; vertical-align: middle" src="http://i.creativecommons.org/l/by/4.0/80x15.png"></img></a>
<span style="vertical-align: middle"><a href="http://github.com/martinschimak" property="cc:attributionName" rel="cc:attributionURL">Martin Schimak</a>, 
<a href="http://plexiti.com" property="cc:attributionName" rel="cc:attributionURL">plexiti GmbH</a></span>
</div>

            
        </div>



<script type="text/javascript" src="../js/docs.js"></script>

    </body>
</html>
