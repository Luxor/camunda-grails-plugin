<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>4.3 Configure the camunda plugin 0.3.0-SNAPSHOT</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/introduction.html"><strong>1</strong><span>Introduction</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/get-started.html"><strong>2</strong><span>Get Started</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/conventions.html"><strong>3</strong><span>A Word about Conventions</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/usage.html"><strong>4</strong><span>User Guide</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/testing.html"><strong>5</strong><span>Testing Guide</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/resources.html"><strong>6</strong><span>Further Resources</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        <span id="logo"><span style="white-space: nowrap"><img alt="camunda Logo" title="camunda Grails plugin" src="http://plexiti.github.io/camunda-grails-plugin/img/camunda.png" style="margin-right: 10px"/><span style="vertical-align: middle; font-size: 2.5em">camunda Grails plugin</span><br/><br/></span></span>
        
        
        <span id="sponsor"><span style="vertical-align: middle"><a href="http://plexiti.com" target="_blank"><img alt="plexiti Logo" title="plexiti GmbH" src="http://plexiti.github.io/camunda-grails-plugin/img/plexiti.png"/></a></span></span>
        
    </div>
    <p>The camunda Grails plugin integrates the camunda BPM platform with the Grails web application framework.</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/conventions.html">&lt;&lt; <strong>3</strong><span>A Word about Conventions</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../../guide/testing.html"><strong>5</strong><span>Testing Guide</span> >></a></div>
                


                <div class="project">
                    <h1>4.3 Configure the camunda plugin - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Martin Schimak</p>

                    <p><strong>Version:</strong> 0.3.0-SNAPSHOT</p>

                    
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#deployment-scenario"><strong>4.1</strong><span>Set the deployment scenario</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#process-engine-configuration"><strong>4.2</strong><span>Configure your process engine</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#configuration-possibilities"><strong>4.3</strong><span>Use primitive types, any object or even spring beans</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#jul-logging"><strong>4.4</strong><span>Consider 'java.util.logging' settings</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#alternative-database"><strong>4.5</strong><span>Use a different database</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#alternative-engine-version"><strong>4.6</strong><span>Use an alternative version of camunda</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#bean-names"><strong>4.7</strong><span>Provide alternative bean names</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#override-configuration"><strong>4.8</strong><span>Override plugin configuration with custom beans</span></a>
                    </div>
                    
                </div>
                

                

<h2 id="configuration">4.3 Configure the camunda plugin</h2>
It is not necessary to add configuration in order to <a href="../guide/single.html#get-started" class="guide">get started</a>. However,
you will need some configuration to deploy to other environments than <strong class="bold">dev</strong>elopment and <strong class="bold">test</strong>.
The plugin provides the possibility to adapt to your specific requirements by adding a new
section '<strong class="bold">camunda</strong>' to your <strong class="bold">Config.groovy</strong> (either top-level or beneath a specific environment):<p class="paragraph"/><div class="code"><pre>camunda &#123;
  &#8230;
&#125;</pre></div><p class="paragraph"/><blockquote class="note"> You will need such a configuration section to deploy to other environments than
<strong class="bold">dev</strong>elopment and <strong class="bold">test</strong>. Find out more in the following two chapters. </blockquote>


<h2 id="deployment-scenario">4.3.1 Set the deployment scenario</h2>
You can set the <a href="http://docs.camunda.org/latest/guides/user-guide/#introduction-architecture-overview-camunda-bpm-platform-architecture" target="blank">deployment
scenario</a>
for your process engine. The plugin currently supports the deployment scenarios 
<ul class="minus">
<li>'<strong class="bold">embedded</strong>' (default): the process engine is embedded into your grails application and started and stopped with your grails application lifecycle</li>
<li>'<strong class="bold">none</strong>': the process engine configuration and startup is turned off</li>
</ul><p class="paragraph"/><div class="code"><pre>camunda &#123;
  deployment.scenario = <span class="java&#45;quote">"embedded"</span> // (or <span class="java&#45;quote">"none"</span>)
&#125;</pre></div><p class="paragraph"/><blockquote class="note">
The value 'embedded' is the <strong class="bold">default</strong> in case you do not set and change it explicitely.
</blockquote>



<h2 id="process-engine-configuration">4.3.2 Configure your process engine</h2>
You can fully control your embedded camunda process engine configuration via Config.groovy:<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      &#8230;
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/>Find a full specification of the values possible in the camunda docs for the spring <a href="http://docs.camunda.org/latest/api-references/javadoc/org/camunda/bpm/engine/spring/SpringProcessEngineConfiguration.html" target="blank">process
engine configuration</a>.<p class="paragraph"/>Note that in case you do not configure a value the plugin relies on the default values coming
with the camunda engine in use - with the following two exceptions for the default grails
environments <strong class="bold">dev</strong>elopment and <strong class="bold">test</strong>:
<ul class="minus">
<li>your database is populated with camunda tables the first time the database is accessed</li>
<li>any *.bpmn process definitions found in the classpath will be deployed to the database</li>
</ul><p class="paragraph"/><blockquote class="note">This choice was made in order to make it as easy as possible to <a href="../guide/single.html#get-started" class="guide">get
started</a> while relying on explicit configuration choices when deploying to
other (and potentially production) databases.</blockquote><p class="paragraph"/>That means if you want to have that same behaviour for any other environment, you need to
explicitely configure that in Config.groovy:<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      databaseSchemaUpdate = <span class="java&#45;keyword">true</span>
      deploymentResources = &#91;'classpath:/&#42;&#42;/&#42;.bpmn'&#93;
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/>Obviously you can also change the configuration for the environments development and test, for
the sake of the example e.g. to the current camunda defaults used for the grails environment
<strong class="bold">prod</strong>uction:<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      databaseSchemaUpdate = <span class="java&#45;keyword">false</span>
      deploymentResources = &#91;&#93;
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/><blockquote class="note"> Please be aware that during integration test phase of any environment, two more camunda
configuration values are set by the plugin: the camunda job executor is turned off and service
mocking is made available. Find more information about that in section
<a href="../guide/single.html#testing" class="guide">testing</a>.</blockquote>


<h2 id="configuration-possibilities">4.3.3 Use primitive types, any object or even spring beans</h2>
For configuration, you can of course use primitive typed configuration values such as Strings and booleans, like e.g.<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      processEngineName = <span class="java&#45;quote">"myCustomName"</span>
      databaseSchemaUpdate = <span class="java&#45;keyword">false</span>
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/>but also any object available in Config.groovy or directly constructed within it, like e.g.<p class="paragraph"/><div class="code"><pre>List&#60;BpmnParseListener&#62; parseHandlers = <span class="java&#45;keyword">new</span> ArrayList&#60;BpmnParseListener&#62;();
parseHandlers.add(<span class="java&#45;keyword">new</span> CustomParseHandler());<p class="paragraph"/>camunda &#123;
    engine &#123;
        configuration &#123;
            preParseListeners = parseHandlers
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/>or even spring beans configured e.g. via '<strong class="bold">grails-app/conf/spring/resources.groovy</strong>' or e.g. via '<strong class="bold">grails-app/conf/DataSource.groovy</strong>',
simply referencing them via their <strong class="bold">bean name</strong>:<p class="paragraph"/><div class="code"><pre>camunda &#123;
    engine &#123;
        configuration &#123;
            dataSource = <span class="java&#45;quote">"dataSource_camunda"</span>
        &#125;
    &#125;
&#125;</pre></div>



<h2 id="jul-logging">4.3.4 Consider 'java.util.logging' settings</h2>
camunda uses <a href="http://docs.camunda.org/latest/guides/user-guide/#process-engine-logging" target="blank">java.util.logging</a>.
Therefore you need to make a conscious choice about whether to turn on/off the 'grails.logging.jul.usebridge'
setting in your Config.groovy. See the information about the performance impact on
<a href="http://www.slf4j.org/legacy.html#jul-to-slf4j" target="blank">http://www.slf4j.org</a>.<p class="paragraph"/><strong class="bold">In case the bridge is not turned off explicitely by you, the plugin will turn it on for all Grails test phases.</strong>
However, your explicit choice won't be overridden.<p class="paragraph"/><blockquote class="note">This decision in particular makes sure that the bridge is turned on for tests executed in the default Grails
environment '<strong class="bold">test</strong>', for which no explicit setting is made in the default grails application. As soon as you make
an explicit decision for any of your default or custom environments, the plugin won't interfere anymore.</blockquote>


<h2 id="alternative-database">4.3.5 Use a different database</h2>
camunda's ORM mapping is provided by the mybatis mapping framework. Therefore the plugin can -
and does by default - reuse your Grails 'dataSource' and 'transactionManager' beans, however it
needs to be informed about a databaseType different from Grails default 'h2':<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      databaseType = <span class="java&#45;quote">"postgres"</span> // one of (as of writing): &#91;h2, mysql, oracle, postgres, mssql, db2&#93;
    &#125;
  &#125;
&#125;</pre></div><p class="paragraph"/>Find here a list of camunda's <a href="http://docs.camunda.org/7.0/guides/user-guide/#introduction-supported-environments" target="blank">enviroments supported</a> 
by the version bundled with the plugin and the corresponding 
<a href="http://docs.camunda.org/latest/guides/user-guide/#process-engine-database-configuration" target="blank">configuration values</a> 
for different database types.<p class="paragraph"/>You can also point the process engine to a different database than the one you use for your grails 
domain objects. First configure it in your '<strong class="bold">grails-app/conf/DataSource.groovy</strong>'...<p class="paragraph"/><div class="code"><pre>dataSource &#123;
  dbCreate = <span class="java&#45;quote">"create&#45;drop"</span> // one of 'create', 'create&#45;drop', 'update', 'validate', ''
  url = <span class="java&#45;quote">"jdbc:h2:mem:devDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE"</span>
&#125;
&#8230;
dataSource_camunda &#123;
  dbCreate = <span class="java&#45;quote">"create&#45;drop"</span> // one of 'create', 'create&#45;drop', 'update', 'validate', ''
  url = <span class="java&#45;quote">"jdbc:h2:mem:devDbCamunda;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE"</span>
&#125;</pre></div><p class="paragraph"/>&#8230; then reference this alternative dataSource bean in '<strong class="bold">grails-app/conf/Config.groovy</strong>':<p class="paragraph"/><div class="code"><pre>camunda &#123;
  engine &#123;
    configuration &#123;
      dataSource = <span class="java&#45;quote">"dataSource_camunda"</span>
    &#125;
  &#125;
&#125;</pre></div>



<h2 id="alternative-engine-version">4.3.6 Use an alternative version of camunda</h2>
Currently the plugin comes bundled with a dependency to the release <strong class="bold">7.1.0-Final</strong> of camunda BPM.
However you may want to choose another version. You then have to explicitely override the needed 
dependencies in your BuildConfig.groovy:<p class="paragraph"/><div class="code"><pre>dependencies &#123;
  compile (<span class="xml&#45;quote">"org.camunda.bpm:camunda&#45;engine:$camundaVersion"</span>) &#123;
    excludes 'spring&#45;beans'
  &#125;
  runtime (<span class="xml&#45;quote">"org.camunda.bpm:camunda&#45;engine&#45;spring:$camundaVersion"</span>) &#123;
    excludes 'spring&#45;context', 'spring&#45;jdbc', 'spring&#45;orm'
  &#125;
&#125;</pre></div><p class="paragraph"/>Replace '$camundaVersion' with the version of camunda of your choice. It is recommended to
explicitely exclude any spring dependencies coming with camunda and make sure to properly test
your application with the spring framework version provided by the Grails version you use.<p class="paragraph"/>Note that for camunda versions prior to 7.1.0-Final, you must also configure camunda's custom 
maven repository:<p class="paragraph"/><div class="code"><pre>repositories &#123;
    mavenRepo <span class="java&#45;quote">"https://app.camunda.com/nexus/content/groups/<span class="java&#45;keyword">public</span>"</span>
  &#125;</pre></div>



<h2 id="bean-names">4.3.7 Provide alternative bean names</h2>
Many of camunda's API service names are quite generic (like 'taskService', 'managementService' etc) and could
easily clash with names you want to use in your application for other purposes - even more so when having in mind
the Grails naming convention to use <strong class="bold">&#42;Service</strong> as a name pattern for Grails services. On the other hand typical
camunda users are used to the established service names and will expect to use these services via their
established names. Therefore the plugin provides these services via the <a href="../guide/single.html#services" class="guide">established names</a>.
However, in order to avoid potential name conflicts with grails services pre-existing in your project, the plugin
also allows to change these default bean names via configuration:<p class="paragraph"/><div class="code"><pre>camunda &#123;
  beans.runtimeService = 'myCamundaRuntimeService'
&#125;</pre></div><p class="paragraph"/>Internally the plugin realises this with Spring's bean aliasing mechanism. Instead of the default 
alias 'runtimeService' the custom alias 'myCamundaRuntimeService' is used. You can then inject
your 'org.camunda.bpm.engine.RuntimeService'-typed bean as<p class="paragraph"/><div class="code"><pre>def myCamundaRuntimeService</pre></div>


<h2 id="override-configuration">4.3.8 Override plugin configuration with custom beans</h2>
Of course, it is also possible to override some or all of the camunda spring beans defined by the
plugin via the standard Grails way: by editing '<strong class="bold">grails-app/conf/spring/resources.groovy</strong>'. In
order to do that properly it is useful to know that the plugin registers all beans following the
name convention <strong class="bold">camunda&#91;DefaultAlias&#93;Bean</strong>, e.g. the 'processEngine' is registered as bean
'camundaProcessEngineBean', then given either its default alias 'processEngine' (or its <a href="../guide/single.html#bean-names" class="guide">custom
alias</a> defined by the user).<p class="paragraph"/><blockquote class="note"> This decision was made partly in order to allow the configuration of <a href="../guide/single.html#bean-names" class="guide">alternative bean
names</a>, partly because some historic 2.3 versions of Grails display issues with
custom spring beans named in potential "conflict" with the *Service name convention for Grails
services. </blockquote>



                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/conventions.html">&lt;&lt; <strong>3</strong><span>A Word about Conventions</span></a></div>
                
                    <div class="toc-item next-right"><a href="../../guide/testing.html"><strong>5</strong><span>Testing Guide</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Beans</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../../ref/Beans/authorizationService.html">authorizationService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Beans/formService.html">formService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Beans/historyService.html">historyService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Beans/identityService.html">identityService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Beans/managementService.html">managementService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Beans/processEngine.html">processEngine</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Beans/repositoryService.html">repositoryService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Beans/runtimeService.html">runtimeService</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Beans/taskService.html">taskService</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Command Line</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../../ref/Command%20Line/create-process.html">create-process</a>
                            </div>
                            
                            </div>
                    </div>
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    <div>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons 4.0" style="border-width:0; vertical-align: middle" src="http://i.creativecommons.org/l/by/4.0/80x15.png"></img></a>
<span style="vertical-align: middle"><a href="http://github.com/martinschimak" property="cc:attributionName" rel="cc:attributionURL">Martin Schimak</a>, 
<a href="http://plexiti.com" property="cc:attributionName" rel="cc:attributionURL">plexiti GmbH</a></span>
</div>

    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
